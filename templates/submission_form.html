{% extends 'base.html' %}
{% block content %}
<div class="form-group-final">
    <div class="inner-form-final">
        <br><br>
        <div>
            <div id="wrapper">
                <div id="summary-title"><h3>REQUEST DETAILS</h3></div>
            </div>
            <div class="content">
                <div class="dates-section">
                    <b>Dates</b>

                    <div id="selected-dates-border">
                        <div id="selected-dates">
                            {{ date_start }} - {{ date_end }}
                        </div>
                    </div>      
                </div>
                <div id="selected-sites">
                    {% for campsite in list_of_objs %}
                    <ul class="tent">
                        <li><b> 
                            {{ campsite.name }} in {{ campsite.park }}</b>
                            <br>{{ available[loop.index0] }}
                        </li>
                        
                    </ul>
                    {% endfor %}
                </div>
                <div class="rec-gov-link">If sites are available, book now at <a href='https://www.recreation.gov/'> recreation.gov</a>
                </div>
                
                <form action="/submit" class="submit-request" id="submit-form" method="POST" >
                Phone number to alert: 
                    <input type="text" name="phone">
                        <div id="invalid-message">
                        </div><br><br>
                <button type="submit" id="submit-request-button">Submit Request </button>
            </form>
            </div><br>
        </div>
    </div>
</div>

<script>
    $("#submit-form").on("submit", 
        (evt) => { 
            evt.preventDefault();
            evt.stopPropagation();
            $.get("/validate-phone-number.json", {"phone": $("#submit-form input").val()}, (resp) => {
                if (resp.is_valid) {
                    evt.target.submit();
                } else {
                    $("#invalid-message").html("Invalid phone number!");
                }
                
            })
        }
    );
</script>
{% endblock %}
